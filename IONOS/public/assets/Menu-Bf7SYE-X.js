import{j as e,i as t,o as a,m as s,p as n,q as r}from"./icons-BMG8wf9c.js";import{r as l,a as i}from"./index-B2VKeZc6.js";import"./vendor-eVk5PToZ.js";const o=({isOpen:a,onClose:s,imageUrl:n,altText:r="Image en grand"})=>(l.useEffect(()=>{const e=e=>{"Escape"===e.key&&s()};return a&&(document.body.style.overflow="hidden",document.addEventListener("keydown",e)),()=>{document.body.style.overflow="auto",document.removeEventListener("keydown",e)}},[a,s]),a&&n?e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 z-50 flex justify-center items-center p-4 animate-fade-in",onClick:s,"aria-modal":"true",role:"dialog",children:[e.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] bg-white rounded-lg shadow-2xl animate-slide-up",onClick:e=>e.stopPropagation(),children:[e.jsx("img",{src:n,alt:r,className:"object-contain max-w-full max-h-[90vh] rounded-lg"}),e.jsx("button",{onClick:s,className:"absolute -top-3 -right-3 bg-white text-gray-800 p-2 rounded-full shadow-lg hover:bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-agria-green","aria-label":"Fermer",children:e.jsx(t,{className:"h-6 w-6"})})]}),e.jsx("style",{children:"\n                .animate-fade-in { animation: fadeIn 0.2s ease-out forwards; }\n                .animate-slide-up { animation: slideUp 0.3s ease-out forwards; }\n                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }\n                @keyframes slideUp { from { transform: translateY(20px) scale(0.95); opacity: 0; } to { transform: translateY(0) scale(1); opacity: 1; } }\n            "})]}):null),c="weeklyMenu",d=()=>{const[t,d]=l.useState(null),[m,u]=l.useState(!0),[x,f]=l.useState(!1),[g,h]=l.useState(null),p=["LUNDI","MARDI","MERCREDI","JEUDI","VENDREDI"],[j,b]=l.useState(null);l.useEffect(()=>{const e=(new Date).getDay();h({1:"LUNDI",2:"MARDI",3:"MERCREDI",4:"JEUDI",5:"VENDREDI"}[e]||null)},[]),l.useEffect(()=>{(async()=>{u(!0);try{const e=await i.getMenu();if(e)Object.values(e).forEach(e=>{e.forEach(e=>{e.items&&e.items.forEach(e=>{e.id||(e.id=`item-${Date.now()}-${Math.random().toString(36).substr(2,9)}`)})})}),d(e);else{const e=localStorage.getItem(c);if(e){let t=JSON.parse(e);Object.values(t).forEach(e=>{e.forEach(e=>{e.items&&e.items.forEach(e=>{e.id||(e.id=`item-${Date.now()}-${Math.random().toString(36).substr(2,9)}`)})})}),d(t)}else d(null)}}catch(e){try{const e=localStorage.getItem(c);if(e){let t=JSON.parse(e);Object.values(t).forEach(e=>{e.forEach(e=>{e.items&&e.items.forEach(e=>{e.id||(e.id=`item-${Date.now()}-${Math.random().toString(36).substr(2,9)}`)})})}),d(t)}else d(null)}catch(t){d(null)}}finally{setTimeout(()=>u(!1),200)}})()},[]);const y=t&&g?t[g]:[];return e.jsxs("div",{id:"menu",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8",children:[e.jsxs("div",{className:"text-left mb-4 sm:mb-0",children:[e.jsx("h2",{className:"text-4xl lg:text-5xl font-bold font-serif text-gray-800",children:"Menu du Jour"}),e.jsx("p",{className:"text-lg text-gray-500 mt-1",children:g?`Aujourd'hui, ${(new Date).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"})}`:"Consultez le menu de la semaine"})]}),t&&!m&&e.jsxs("button",{onClick:async()=>{if(t){f(!0);try{const{jsPDF:e}=jspdf,a=new e("p","mm","a4"),s=a.internal.pageSize.getHeight(),n=a.internal.pageSize.getWidth(),r=15;let l=r+10;const i=e=>{l+e>s-r&&(a.addPage(),l=r)};a.setFont("times","bold"),a.setFontSize(24),a.text("Menu de la Semaine",n/2,l,{align:"center"}),l+=15;for(const o of p){if(!t[o]||0===t[o].length)continue;i(20),a.setFont("helvetica","bold"),a.setFontSize(18),a.setTextColor("#009A58"),a.text(o,r,l),l+=10,a.setTextColor(0,0,0);const e=t[o];for(const t of e)if(0!==t.items.length){i(10),a.setFont("helvetica","bold"),a.setFontSize(12),a.text(t.title,r+5,l),l+=6,a.setFont("helvetica","normal"),a.setFontSize(10);for(const e of t.items){const t=a.splitTextToSize(e.name,n-2*r-15),s=5*t.length;i(s),a.text(t,r+10,l),l+=s}l+=4}l+=5}a.save("menu-de-la-semaine.pdf")}catch(e){}finally{f(!1)}}},disabled:x,className:"bg-agria-green hover:bg-agria-green-dark text-white font-semibold py-2 px-4 border border-transparent rounded-lg shadow-sm transition-all duration-300 transform hover:scale-105 inline-flex items-center gap-2 disabled:opacity-50 self-start sm:self-center",children:[x?e.jsx(a,{size:"small"}):e.jsx(s,{className:"h-5 w-5"}),x?"Génération...":"Menu de la semaine (PDF)"]})]}),e.jsx("div",{className:"mt-8",children:m?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(a,{size:"large",className:"text-agria-green"})}):g?t?y&&0!==y.length?e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8 text-left animate-fade-in",children:y.map(t=>e.jsxs("div",{className:"p-6 bg-white border border-gray-200/80 rounded-lg shadow-sm hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[e.jsxs("h3",{className:"text-xl font-bold text-agria-green-dark mb-4 flex items-center gap-3",children:[e.jsx(n,{}),t.title]}),e.jsxs("ul",{children:[t.items.map(t=>e.jsxs("li",{className:"flex items-center gap-4 py-2 border-b border-gray-200 last:border-b-0",children:[t.image?e.jsx("button",{onClick:()=>b({src:t.image,alt:t.name}),className:"focus:outline-none ring-offset-2 focus:ring-2 focus:ring-agria-green rounded-md",children:e.jsx("img",{src:t.image,alt:t.name,className:"w-14 h-14 object-cover rounded-md flex-shrink-0 shadow-sm cursor-zoom-in transform hover:scale-105 transition-transform"})}):e.jsx("div",{className:"w-14 h-14 bg-gray-200 rounded-md flex-shrink-0 flex items-center justify-center text-gray-400",children:e.jsx(r,{className:"h-7 w-7"})}),e.jsx("span",{className:"text-gray-700",children:t.name})]},t.id)),0===t.items.length&&e.jsx("li",{className:"text-sm text-gray-500 italic mt-2",children:"Aucun plat pour cette catégorie."})]})]},t.title))}):e.jsx("p",{className:"col-span-full text-center text-gray-500",children:"Le menu pour aujourd'hui n'est pas encore disponible."}):e.jsxs("div",{className:"text-center bg-gray-100 p-8 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-700",children:"Aucun menu disponible"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Le menu de la semaine sera bientôt publié. Revenez plus tard !"})]}):e.jsxs("div",{className:"text-center bg-gray-100 p-8 rounded-lg",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-700",children:"Le restaurant est fermé aujourd'hui."}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Le menu du jour sera disponible Lundi. Bon week-end !"})]})}),e.jsx(o,{isOpen:!!j,onClose:()=>b(null),imageUrl:(null==j?void 0:j.src)||null,altText:null==j?void 0:j.alt}),e.jsx("style",{children:".animate-fade-in { animation: fadeIn 0.5s ease-in-out; } @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } } .cursor-zoom-in { cursor: zoom-in; }"})]})};export{d as default};
